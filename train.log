nohup: ignoring input
2024-07-02 18:09:46.888502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
pca_result shape: (2458, 10)
Explained Variance by each Principal Component: [0.16828808 0.12645692 0.09364696 0.08195513 0.06946784 0.06466228
 0.04168206 0.0370221  0.03472259 0.03232245]
Cumulative Explained Variance: [0.16828808 0.29474501 0.38839196 0.47034709 0.53981493 0.60447722
 0.64615927 0.68318137 0.71790396 0.7502264 ]
Discretized States Shape: (2458, 10)
State_counts shape: (2, 2, 2, 2, 2, 2, 2, 2, 2, 2)
State Occupancy: [0.01139138 0.         0.03173312 ... 0.         0.         0.        ]
State Occupancy Shape: (1024,)
Sum of State Occupancy (should be 1): 1.0
--------------------------
| grad_norm   | 1.11     |
| iteration   | 0        |
| linf_delta  | 0.0317   |
| weight_norm | 4.8      |
--------------------------
--------------------------
| grad_norm   | 350      |
| iteration   | 100      |
| linf_delta  | 0.0317   |
| weight_norm | 105      |
--------------------------
--------------------------
| grad_norm   | 2e+03    |
| iteration   | 200      |
| linf_delta  | 0.0317   |
| weight_norm | 247      |
--------------------------
--------------------------
| grad_norm   | 5.12e+03 |
| iteration   | 300      |
| linf_delta  | 0.0317   |
| weight_norm | 394      |
--------------------------
--------------------------
| grad_norm   | 9.74e+03 |
| iteration   | 400      |
| linf_delta  | 0.0317   |
| weight_norm | 540      |
--------------------------
--------------------------
| grad_norm   | 1.58e+04 |
| iteration   | 500      |
| linf_delta  | 0.0317   |
| weight_norm | 685      |
--------------------------
--------------------------
| grad_norm   | 2.33e+04 |
| iteration   | 600      |
| linf_delta  | 0.0317   |
| weight_norm | 827      |
--------------------------
--------------------------
| grad_norm   | 3.19e+04 |
| iteration   | 700      |
| linf_delta  | 0.0317   |
| weight_norm | 967      |
--------------------------
--------------------------
| grad_norm   | 4.18e+04 |
| iteration   | 800      |
| linf_delta  | 0.0317   |
| weight_norm | 1.1e+03  |
--------------------------
--------------------------
| grad_norm   | 5.28e+04 |
| iteration   | 900      |
| linf_delta  | 0.0317   |
| weight_norm | 1.24e+03 |
--------------------------
/home/yuchen/anaconda3/envs/mujoco316/lib/python3.8/site-packages/sklearn/preprocessing/_discretization.py:248: FutureWarning: In version 1.5 onwards, subsample=200_000 will be used by default. Set subsample explicitly to silence this warning in the mean time. Set subsample=None to disable subsampling explicitly.
  warnings.warn(
/home/yuchen/anaconda3/envs/mujoco316/lib/python3.8/site-packages/stable_baselines3/common/evaluation.py:67: UserWarning: Evaluation environment is not wrapped with a ``Monitor`` wrapper. This may result in reporting modified episode lengths and rewards, if other wrappers happen to modify these. Consider wrapping environment first with ``Monitor`` wrapper.
  warnings.warn(
Traceback (most recent call last):
  File "train_mce_irl_pca.py", line 147, in <module>
    reward_after_training, _ = evaluate_policy(mce_irl.policy, env, 10)
  File "/home/yuchen/anaconda3/envs/mujoco316/lib/python3.8/site-packages/stable_baselines3/common/evaluation.py", line 88, in evaluate_policy
    actions, states = model.predict(
  File "/home/yuchen/anaconda3/envs/mujoco316/lib/python3.8/site-packages/imitation/algorithms/mce_irl.py", line 248, in predict
    assert self.observation_space.contains(obs), "illegal state"
AssertionError: illegal state
